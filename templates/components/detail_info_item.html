{% comment %}
  Path: templates/hrm_manager/quan_ly_nhan_su/partials/detail_info_item.html
  Usage: {% include ".../detail_info_item.html" with label="Label" value=val name="field_name" ... %}
{% endcomment %}

{% with display_value=value|default:"--" field_type=type|default:"text" is_editable=editable|default:True %}
<div class="detail-item-wrapper group h-full {% if full_width %}col-span-full{% endif %} bg-slate-50 rounded-lg p-3.5 border border-slate-100 transition-all duration-200"
     data-original-value="{{ value|default:'' }}">
    
    <div class="flex items-start gap-3 h-full">
        {# --- ICON & COLORS --- #}
        <div class="w-9 h-9 rounded-lg flex-shrink-0 flex items-center justify-center transition-colors
            {% if color == 'blue' %}bg-blue-100 text-blue-600
            {% elif color == 'green' %}bg-green-100 text-green-600
            {% elif color == 'purple' %}bg-purple-100 text-purple-600
            {% elif color == 'orange' %}bg-orange-100 text-orange-600
            {% elif color == 'red' %}bg-red-100 text-red-600
            {% elif color == 'pink' %}bg-pink-100 text-pink-600
            {% elif color == 'teal' %}bg-teal-100 text-teal-600
            {% else %}bg-slate-200 text-slate-600{% endif %}">
            <i class="fas {{ icon }} text-sm"></i>
        </div>
        
        {# --- CONTENT AREA --- #}
        <div class="flex-1 min-w-0 flex flex-col justify-center">
            <label class="text-xs font-medium text-slate-500 uppercase tracking-wider mb-0.5 block">{{ label }}</label>
            
            {# 1. VIEW MODE #}
            <div class="view-mode-content">
                <p class="text-sm font-medium text-slate-900 break-words line-clamp-2" title="{{ display_value }}">
                    {{ display_value }}
                </p>
            </div>

            {# 2. EDIT MODE (Chỉ hiển thị nếu được phép sửa) #}
            {% if name %}
            <div class="edit-mode-content hidden mt-1">
                {% if is_editable %}
                    {% if field_type == 'select' %}
                        <select name="{{ name }}" class="w-full text-sm border-slate-300 rounded focus:ring-blue-500 focus:border-blue-500 py-1 px-2 bg-white shadow-sm">
                            {% for opt_val, opt_label in options %}
                                <option value="{{ opt_val }}" {% if opt_val|stringformat:"s" == value_id|stringformat:"s" or opt_val|stringformat:"s" == value|stringformat:"s" %}selected{% endif %}>
                                    {{ opt_label }}
                                </option>
                            {% endfor %}
                        </select>
                    {% elif field_type == 'date' %}
                        <input type="date" name="{{ name }}" value="{{ value|date:'Y-m-d' }}" 
                               class="w-full text-sm border-slate-300 rounded focus:ring-blue-500 focus:border-blue-500 py-1 px-2 shadow-sm">
                    {% else %}
                        <input type="{{ field_type }}" name="{{ name }}" value="{{ value|default:'' }}" placeholder="Nhập {{ label|lower }}..."
                               class="w-full text-sm border-slate-300 rounded focus:ring-blue-500 focus:border-blue-500 py-1 px-2 shadow-sm">
                    {% endif %}
                {% else %}
                    {# Read-only mode trong lúc edit: Hiển thị input disabled hoặc text xám #}
                    <input type="text" value="{{ display_value }}" disabled
                           class="w-full text-sm border-slate-200 bg-slate-100 text-slate-500 rounded py-1 px-2 cursor-not-allowed">
                {% endif %}
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endwith %}